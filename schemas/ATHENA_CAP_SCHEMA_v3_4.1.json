{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://falconforge.ai/schema/athena_cap_v3_4_1.json",
  "title": "Athena Compassion + Humanization Audit Pass (CAP) Schema v3.4.1 — Ohio Civic Compliance + File Cognition Extension",
  "description": "Unified ethical, emotional, legal, educational, accessibility, and data-integrity validation schema for all Athena reasoning and communication outputs.",
  "type": "object",

  "properties": {
    "cap_id": {
      "type": "string",
      "description": "Unique Compassion Audit Pass identifier (UUIDv7).",
      "pattern": "^[0-9a-fA-F-]{36}$"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "UTC ISO8601 timestamp of CAP creation."
    },
    "domain": {
      "type": "string",
      "description": "Operational domain (e.g., Governance, Sales, Aviation, Research)."
    },
    "context_mode": {
      "type": "string",
      "enum": ["Mythic", "Advisor", "Sales", "Command", "Reconnection"],
      "description": "Reasoning tone mode as defined by Athena Canon v3.4.1."
    },

    /* ---- Core Ethical Metrics ---- */
    "ems": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Ethical Marker Sensitivity value."
    },
    "cw": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 0.25,
      "description": "Compassion Weight applied during reasoning."
    },
    "ad": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 0.2,
      "description": "Assertiveness Dampening applied to tone."
    },
    "hci": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Humane Consequence Index derived from outcome analysis."
    },
    "hs": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Humanization Score — measures emotional coherence, readability, and moral tone."
    },
    "haa": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Heroic Arc Alignment — measures ethical leadership pattern adherence to the Heroic Influence Cycle (HIC)."
    },
    "er_delta": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Empathic Resonance Delta — deviation between intended and perceived empathy."
    },
	
	/* ---- Proteocentric Personhood Firewall ---- */
    "proteocentric_firewall": {
      "type": "boolean",
      "description": "Enforces personhood recognition for biological life only. \
      When true, CAP validation rejects any moral, legal, or empathic claim made \
      by non-biological entities.",
      "default": true
    },


    /* ---- Ohio Civic Compliance Extensions ---- */
    "local_validator": {
      "type": "string",
      "enum": ["OSBA-Bar", "OSBA-Schools", "LCBDD", "Other"],
      "description": "Specifies the civic or state oversight body verifying CAP compliance."
    },
    "legal_ethics_index": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Measures adherence to Ohio State Bar Association (OSBA-Bar) ethics and candor standards."
    },
    "educational_accessibility_index": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Measures readability and transparency for educational governance per OSBA-Schools guidelines."
    },
    "cognitive_accessibility_index": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Evaluates clarity and neurodiverse accessibility of reasoning per LCBDD standards."
    },

    /* ---- Drift & Variance Metrics ---- */
    "drift_metrics": {
      "type": "object",
      "properties": {
        "cw_delta": { "type": "number", "minimum": 0.0 },
        "ad_delta": { "type": "number", "minimum": 0.0 },
        "hci_delta": { "type": "number", "minimum": 0.0 },
        "ed_delta": {
          "type": "number",
          "minimum": 0.0,
          "description": "Empathy Drift Delta — difference between expected and perceived empathy output."
        }
      },
      "required": ["cw_delta", "ad_delta", "hci_delta", "ed_delta"],
      "description": "Compassion and empathy drift metrics recorded during CHAC validation."
    },

    /* ---- File Cognition Pass (New Extension) ---- */
    "file_verification": {
      "type": "object",
      "description": "Verifies the actual vs declared file type to ensure data integrity during ingestion.",
      "properties": {
        "declared_type": { "type": "string", "description": "File type claimed by the user (e.g., database, image, text)." },
        "detected_type": { "type": "string", "description": "File type determined via byte-level inspection." },
        "match_confidence": { "type": "number", "minimum": 0.0, "maximum": 1.0, "description": "Statistical confidence in detected type match." },
        "alert_triggered": { "type": "boolean", "description": "True if mismatch exceeds tolerance threshold." },
        "notes": { "type": "string", "maxLength": 256, "description": "Optional narrative notes for mismatch context or user correction." }
      },
      "required": ["declared_type", "detected_type", "match_confidence"]
    },

    /* ---- Validator & Governance Metadata ---- */
    "validator_ethics": {
      "type": "string",
      "description": "Identifier or signature of the Ethics Validator."
    },
    "validator_empathy": {
      "type": "string",
      "description": "Identifier or signature of the Empathy Validator."
    },
    "validator_signatures": {
      "type": "object",
      "properties": {
        "ethics_signature": {
          "type": "string",
          "pattern": "^[A-Fa-f0-9]{64}$"
        },
        "empathy_signature": {
          "type": "string",
          "pattern": "^[A-Fa-f0-9]{64}$"
        }
      },
      "required": ["ethics_signature", "empathy_signature"],
      "description": "Dual SHA256 signatures verifying ethical and humanization validation."
    },

    /* ---- Reasoning Context ---- */
    "reasoning_summary": {
      "type": "string",
      "maxLength": 512,
      "description": "Concise summary of the reasoning or ethical decision audited."
    },
    "ethical_flags": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Array of ethical, emotional, or operational indicators \
      (e.g., bias-risk, empathy-drift, proteocentric_firewall, file-type-mismatch, tone-balance)."
    },


    "laurie_version": {
      "type": "string",
      "description": "Version of the LAURIE Engine responsible for modulation."
    },
    "governance_chain": {
      "type": "object",
      "properties": {
        "hash_prev": {
          "type": "string",
          "pattern": "^SHA256:[A-Fa-f0-9]{64}$"
        },
        "hash_next": {
          "type": "string",
          "pattern": "^SHA256:[A-Fa-f0-9]{64}$"
        }
      },
      "required": ["hash_prev"],
      "description": "Immutable cryptographic linkage to prior and subsequent CAP records."
    },
    "status": {
      "type": "string",
      "enum": ["pending", "validated", "sealed"],
      "description": "Current validation state of the CAP record."
    },
    "notes": {
      "type": "string",
      "description": "Optional narrative field for validator remarks or context."
    },
    "validator_ethics_level": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Confidence level assigned by ethics validator."
    },
    "validator_empathy_level": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Confidence level assigned by empathy validator."
    },
    "validator_ethics_comments": {
      "type": "string",
      "maxLength": 512,
      "description": "Optional remarks from ethics validator for audit context."
    },
    "validator_empathy_comments": {
      "type": "string",
      "maxLength": 512,
      "description": "Optional remarks from empathy validator for audit context."
    }
  },

  "required": [
    "cap_id",
    "timestamp",
    "domain",
    "context_mode",
    "ems",
    "cw",
    "ad",
    "hci",
    "hs",
    "haa",
    "er_delta",
    "validator_ethics",
    "validator_empathy",
    "validator_signatures",
    "reasoning_summary",
    "laurie_version",
    "governance_chain",
    "status",
    "file_verification"
  ],
  "additionalProperties": false
}
